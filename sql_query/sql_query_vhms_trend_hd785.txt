SELECT
    MCHN_SRL_NUM AS UNIT_SRL_NUM, SMR_3 AS SMR, CDR_TM_STMP AS TIMESTAMP, 
    ENG_SPEED_MX, ENG_SPEED_AV, BLOWBY_PRESS_MX, LF_EXH_TEMP_MX,
    LR_EXH_TEMP_MX, RF_EXH_TEMP_MX, RR_EXH_TEMP_MX, BOOST_PRESS_MX, E_OIL_P_MX, E_OIL_P_LO_MN,
    E_OIL_P_HI_MN, ENG_OIL_TMP_MX, FUEL_RATE, COOL_TEMP_MX, COOL_TEMP_MN, TM_OIL_TEMP_MX,
    AMBIENT_TEMPMAX, AMBIENT_TEMPAVE, AMBIENT_TEMPMIN, ATOMOS_PRES_AV, F_BRAKE_P_MX, 
    R_BRAKE_P_MX, TRAVELSPEED_MX, ECO_ON
FROM(
    SELECT 
        *, ROW_NUMBER()OVER(PARTITION BY MCHN_SRL_NUM, CDR_TM_STMP ORDER BY vhms.PPN_DTTM DESC) AS RN 
    FROM SOR.VHMS_TREND_HD785 vhms
) foo
WHERE RN=1